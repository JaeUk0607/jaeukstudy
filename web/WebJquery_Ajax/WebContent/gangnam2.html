<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
<script type="text/javascript">
	$(function() {
		
		var h = 0;
		var k = 0;
		var c = 0;
		var b = 0;
		var j = 0;
		$('#btn')
				.click(
						function() { /* 출력 버튼 클릭시  */
							$('#display').empty();

							$
									.ajax({
										url : 'http://openapi.gangnam.go.kr:8088/7842674c6b6a696e35336f50735752/json/GnModelRestaurantDesignate/1/1000/',
										dataType : "json", //서버가 client 응답 형식 : html
										success : function(responsedata) {
											var table = "<table border='1'>";
											table += "<tr><th>지정일자</th><th>업소명</th><th>소재지도로명</th><th>업태명</th><th>주된음식</th><th>행정동명</th><th>소재지전화번호</th></tr>"

											$
													.each(
															responsedata.GnModelRestaurantDesignate.row,
															function(index, obj) {
																if (obj.SNT_UPTAE_NM == $(
																		"select > option:selected")
																		.val()) {
																	table += "<tr>";
																	table += "<td>"
																			+ obj.ASGN_YMD
																			+ "</td>";
																	table += "<td>"
																			+ obj.UPSO_NM
																			+ "</td>";
																	table += "<td>"
																			+ obj.SITE_ADDR_RD
																			+ "</td>";
																	table += "<td>"
																			+ obj.SNT_UPTAE_NM
																			+ "</td>";
																	table += "<td>"
																			+ obj.MAIN_EDF
																			+ "</td>";
																	table += "<td>"
																			+ obj.ADMDNG_NM
																			+ "</td>";
																	table += "<td>"
																			+ obj.UPSO_SITE_TELNO
																			+ "</td>";
																	table += "</tr>";
																}
															});
											table += "</table>";

											$('#display').html(table);
											$
													.each(
															responsedata.GnModelRestaurantDesignate.row,
															function(index, elt) {
																console
																		.log(elt);
																if (elt.SNT_UPTAE_NM == "한식") {
																	h++;
																	console
																			.log("메롱멍청아");
																	console
																			.log("기계는 거짓말을 하지 않아");
																} else if (elt.SNT_UPTAE_NM == "경양식") {
																	k++;
																} else if (elt.SNT_UPTAE_NM == "중국식") {
																	c++;
																} else if (elt.SNT_UPTAE_NM == "분식") {
																	b++;
																} else {
																	j++;
																}

															});
											var ctx = document.getElementById(
													"myChart").getContext('2d');
											var myChart = new Chart(
													ctx,
													{

														type : 'bar',
														data : {
															labels : [ "한식",
																	"경양식",
																	"중국식",
																	"분식", "일식" ],
															datasets : [ {
																label : '# of Votes',
																data : [ h, k,
																		c, b, j ],
																backgroundColor : [
																		'rgba(255, 99, 132, 0.2)',
																		'rgba(54, 162, 235, 0.2)',
																		'rgba(255, 206, 86, 0.2)',
																		'rgba(75, 192, 192, 0.2)',
																		'rgba(153, 102, 255, 0.2)',

																],
																borderColor : [
																		'rgba(255,99,132,1)',
																		'rgba(54, 162, 235, 1)',
																		'rgba(255, 206, 86, 1)',
																		'rgba(75, 192, 192, 1)',
																		'rgba(153, 102, 255, 1)',

																],
																borderWidth : 1,
																
																
															} ]
														},
														options : {
															scales : {
																yAxes : [ {
																	ticks : {
																		beginAtZero : true
																	}
																} ]
															}
														}
													});
											
										}
									});
							
							
						});
	});

</script>
</head>
<body>
	<input type="button" id="btn" value="검색하기">
	<select id="line">
		<option>한식</option>
		<option>경양식</option>
		<option>중국식</option>
		<option>분식</option>
		<option>일식</option>

	</select>
	<hr>
	<div id="display"></div>
	<canvas id="myChart" style="width: 100px; height: 100px"></canvas>
	<input type="button" id= "btn1" value="크기">
</body>
</html>